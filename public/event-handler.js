"use strict";module.exports=class{constructor(){this._map=new Map}addEventListener(t,e,s={}){let i=this._map.get(t);i||(i=[],this._map.set(t,i));let n=!0;for(const t of i)if(t.listener===e){t.options=s,n=!1;break}return n&&i.push({listener:e,options:s}),n}removeEventListener(t,e){const s=this._map.get(t);if(s){let t=0;for(const i of s){if(i.listener===e)return s.splice(t,1),!0;t++}}return!1}async dispatchEvent(t,e={}){const s=[],i=this._map.get(t);if(i)for(const{listener:n,options:o}of[...i]){const i=n({type:t,target:this,data:{...o.data||{},...e}});s.push(i),o.once&&this.removeEventListener(t,n),o.wait&&await i}await Promise.all(s)}};
